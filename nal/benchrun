#!/usr/bin/env rc

nalt=`{mktemp '/tmp/nalt.XXXXXX'}

for(i in (nalfg nalgl)){
	for(j in `{cat data/files}){
		echo -n $i': '$j': '
		time ./$i >[1=2] <$j >$nalt |[2] head -1 | awk '{ print $2 }'

		if(! cmp $j $nalt) {
			echo 'error: file '$j' not copied correctly.' >[1=2]
			rm $nalt
			exit 1
		}
	}
}

rm $nalt
